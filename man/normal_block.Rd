% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/normal_block.R
\name{normal_block}
\alias{normal_block}
\title{Normal-block model}
\usage{
normal_block(
  Y,
  X,
  nb_blocks = NULL,
  blocks = NULL,
  sparsity = 0,
  zero_inflation = FALSE,
  niter = 100,
  threshold = 1e-04,
  verbose = TRUE
)
}
\arguments{
\item{Y}{observations data, n observations of p categories, dim n*p.}

\item{X}{covariates data, n observations of d covariates, dim n*d.}

\item{nb_blocks}{number of blocks (if fixed) or list of possible number of blocks otherwise}

\item{blocks, }{if known, under the form of a p * Q matrix}

\item{sparsity}{sparsity factor to apply to blocks covariance matrix (or possibly list of such values with same length as nb_blocks)}

\item{zero_inflation}{boolean to indicate if Y is zero-inflated and adjust fitted model as a consequence}

\item{niter}{number of iterations in model optimization}

\item{threshold}{loglikelihood / elbo threshold under which optimization stops}

\item{verbose}{telling if information should be printed during optimization}
}
\value{
an R6 object with class [`NB`] or [`NB_unknown`] or [`NB_unknown_ZI`]
}
\description{
Fit a normal-block model with a variational algorithm
}
\examples{
data("example_data")
Y <- example_data$Y
X <- example_data$X
C <- example_data$C
my_normal_block <- normal_block(Y, X, nb_blocks = 1:6)
oracle <- normal_block(Y, X, blocks = C)
\dontrun{
my_normal_block$plot_criterion("loglik")
my_normal_block$plot_criterion("BIC")
my_normal_block$plot_criterion("ICL")
Y_hat <- my_normal_block$get_best_model()$fitted
Y_hat <- oracle$fitted
plot(Y, Y_hat); abline(0,1)
}
}
